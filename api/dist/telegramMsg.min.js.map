{"version":3,"sources":["telegramMsg.js"],"names":["module","exports","sendMsg","req","res","http","require","config","reqBody","name","body","email","text","msg","fields","forEach","field","encodeURI","post","telegram","chat","error","response","console","log","statusCode","status","message","json"],"mappings":"aAAAA,OAAOC,QAAQC,QAAU,SAACC,EAAKC,GAA/BJ,IAAOC,EAAQC,QAAU,yBACvBG,EAAAC,QAAA,WACMC,EAASD,EAAAA,KACXD,EAAOC,CAIT,gBAAkBE,EAAQC,KAH5B,iBAAkBC,EAClBC,MAIEH,EAAQI,MAENC,EAAM,GAEVC,EAAOC,QAAQ,SAAAC,GACbH,GAAOG,EAAQ,OAGjBH,EAAMI,UAAUJ,GAEhBR,EAAKa,KAALb,+BAAAA,OAAAE,EAAyCA,SAAOY,MAAhDd,yBAAAA,OAAAE,EAAAY,SAAAC,KAAAf,0BAAAA,OAAAQ,GAAA,SAAAQ,EAAAC,EAA0IZ,GAExIa,QAAQC,IAAI,SAAUH,GACtBE,QAAQC,IAAI,cAAeF,GAAYA,EAASG,YAChDF,QAAQC,IAAI,QAASd,GACI,MAAtBY,EAASG,YAAZrB,EAAGkB,OAASG,KAAAA,KAAT,CAAAC,OAAH,KAA6BC,QAAA,wBACN,MAACD,EAAQD,YAAME,EAAAA,OAAS,KAAAC,KAAA,CAAAF,OAAA,QAAAC,QAAA","file":"telegramMsg.min.js","sourcesContent":["module.exports.sendMsg = (req, res) => {\n  //токен и id чата берутся из config.json\n  const config = require('../config/config.json');\n  let http = require('request')\n  let reqBody = req.body\n  //каждый элемент обьекта запихиваем в массив\n  let fields = [\n    '<b>Name</b>: ' + reqBody.name,\n    '<b>Email</b>: ' + reqBody.email,\n    reqBody.text\n  ]\n  let msg = ''\n  //проходимся по массиву и склеиваем все в одну строку\n  fields.forEach(field => {\n    msg += field + '\\n'\n  });\n  //кодируем результат в текст, понятный адресной строке\n  msg = encodeURI(msg)\n  //делаем запрос\n  http.post(`https://api.telegram.org/bot${config.telegram.token}/sendMessage?chat_id=${config.telegram.chat}&parse_mode=html&text=${msg}`, function (error, response, body) {  \n    //не забываем обработать ответ\n    console.log('error:', error); \n    console.log('statusCode:', response && response.statusCode); \n    console.log('body:', body); \n    if(response.statusCode===200){\n      res.status(200).json({status: 'ok', message: 'Успешно отправлено!'});\n    }\n    if(response.statusCode!==200){\n      res.status(400).json({status: 'error', message: 'Произошла ошибка!'});\n    }\n  });\n\n}"]}