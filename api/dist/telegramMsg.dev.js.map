{"version":3,"sources":["telegramMsg.js"],"names":["module","exports","sendMsg","req","res","config","require","http","reqBody","body","fields","name","email","text","msg","forEach","field","encodeURI","post","telegram","token","chat","error","response","console","log","statusCode","status","json","message"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,CAAeC,OAAf,GAAyB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACrC;AACA,MAAMC,MAAM,GAAGC,OAAO,CAAC,uBAAD,CAAtB;;AACA,MAAIC,IAAI,GAAGD,OAAO,CAAC,SAAD,CAAlB;;AACA,MAAIE,OAAO,GAAGL,GAAG,CAACM,IAAlB,CAJqC,CAKrC;;AACA,MAAIC,MAAM,GAAG,CACX,kBAAkBF,OAAO,CAACG,IADf,EAEX,mBAAmBH,OAAO,CAACI,KAFhB,EAGXJ,OAAO,CAACK,IAHG,CAAb;AAKA,MAAIC,GAAG,GAAG,EAAV,CAXqC,CAYrC;;AACAJ,EAAAA,MAAM,CAACK,OAAP,CAAe,UAAAC,KAAK,EAAI;AACtBF,IAAAA,GAAG,IAAIE,KAAK,GAAG,IAAf;AACD,GAFD,EAbqC,CAgBrC;;AACAF,EAAAA,GAAG,GAAGG,SAAS,CAACH,GAAD,CAAf,CAjBqC,CAkBrC;;AACAP,EAAAA,IAAI,CAACW,IAAL,uCAAyCb,MAAM,CAACc,QAAP,CAAgBC,KAAzD,kCAAsFf,MAAM,CAACc,QAAP,CAAgBE,IAAtG,mCAAmIP,GAAnI,GAA0I,UAAUQ,KAAV,EAAiBC,QAAjB,EAA2Bd,IAA3B,EAAiC;AACzK;AACAe,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBH,KAAtB;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,QAAQ,IAAIA,QAAQ,CAACG,UAAhD;AACAF,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBhB,IAArB;;AACA,QAAGc,QAAQ,CAACG,UAAT,KAAsB,GAAzB,EAA6B;AAC3BtB,MAAAA,GAAG,CAACuB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACD,QAAAA,MAAM,EAAE,IAAT;AAAeE,QAAAA,OAAO,EAAE;AAAxB,OAArB;AACD;;AACD,QAAGN,QAAQ,CAACG,UAAT,KAAsB,GAAzB,EAA6B;AAC3BtB,MAAAA,GAAG,CAACuB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACD,QAAAA,MAAM,EAAE,OAAT;AAAkBE,QAAAA,OAAO,EAAE;AAA3B,OAArB;AACD;AACF,GAXD;AAaD,CAhCD","sourcesContent":["module.exports.sendMsg = (req, res) => {\n  //токен и id чата берутся из config.json\n  const config = require('../config/config.json');\n  let http = require('request')\n  let reqBody = req.body\n  //каждый элемент обьекта запихиваем в массив\n  let fields = [\n    '<b>Name</b>: ' + reqBody.name,\n    '<b>Email</b>: ' + reqBody.email,\n    reqBody.text\n  ]\n  let msg = ''\n  //проходимся по массиву и склеиваем все в одну строку\n  fields.forEach(field => {\n    msg += field + '\\n'\n  });\n  //кодируем результат в текст, понятный адресной строке\n  msg = encodeURI(msg)\n  //делаем запрос\n  http.post(`https://api.telegram.org/bot${config.telegram.token}/sendMessage?chat_id=${config.telegram.chat}&parse_mode=html&text=${msg}`, function (error, response, body) {  \n    //не забываем обработать ответ\n    console.log('error:', error); \n    console.log('statusCode:', response && response.statusCode); \n    console.log('body:', body); \n    if(response.statusCode===200){\n      res.status(200).json({status: 'ok', message: 'Успешно отправлено!'});\n    }\n    if(response.statusCode!==200){\n      res.status(400).json({status: 'error', message: 'Произошла ошибка!'});\n    }\n  });\n\n}"],"file":"telegramMsg.dev.js"}